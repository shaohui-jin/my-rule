# 函数编辑器说明文档

## 概述

函数编辑器是一个基于Vue 3 + TypeScript的Lua函数配置工具，主要用于解析Lua脚本中的特殊注释，自动生成表单配置，实现代码与表单的双向绑定。该工具支持复杂的类型系统、数据压缩优化、模板管理和智能函数检测功能。

## 核心组件架构

### 1. 主要组件结构

```
FuncEdit.vue (主页面)
├── LuaEditor (基于Monaco Editor的Lua代码编辑器)
├── SimpleFormRenderer (动态表单渲染组件)
├── util.js (注释解析和表单配置生成工具)
├── useLuaTemplates.js (Lua模板管理Hook)
└── DataOptimizer.ts (数据压缩和优化工具)
```

### 2. LuaEditor组件特性

#### 2.1 编辑器功能
- **Monaco Editor集成**: 基于VS Code的Monaco Editor
- **语法高亮**: 支持Lua语法高亮和代码着色
- **智能提示**: 代码补全和智能提示功能
- **代码折叠**: 支持代码块折叠和展开
- **全屏编辑**: 支持全屏模式编辑代码
- **代码下载**: 支持将代码下载为.lua文件
- **代码复制**: 一键复制代码内容

#### 2.2 编辑器配置
- **主题**: 支持vs主题
- **字体大小**: 默认12px，可调整
- **行号显示**: 显示行号
- **代码透镜**: 启用代码透镜功能
- **代码折叠**: 自动折叠策略
- **平滑滚动**: 启用平滑滚动动画
- **自动布局**: 响应式布局调整

### 3. 组件职责分工

- **FuncEdit.vue**: 主控制器，负责整体流程协调、数据管理、用户交互和智能函数检测
- **LuaEditor**: 基于Monaco Editor的Lua代码编辑器，支持语法高亮、智能提示、代码折叠、全屏编辑、代码下载和复制功能
- **SimpleFormRenderer**: 动态表单渲染组件，支持多种输入模式、类型显示和参数分组
- **util.js**: Lua注释解析和表单配置生成工具，支持复杂类型分析和高级选项配置
- **useLuaTemplates.js**: Lua模板管理Hook，提供预定义模板和模板操作
- **DataOptimizer.ts**: 数据压缩和优化工具，减少存储空间并提高性能

## Lua注释提取逻辑详解

### 1. 注释识别规则

系统通过以下规则识别和处理Lua注释：

#### 1.1 基础注释格式
- 必须以 `-- @` 开头
- 支持三种主要注释类型：`@param`、`@field`、`@return`
- 注释格式：`-- @param <参数名> <类型> <描述> # [选项配置]`

#### 1.2 参数定义 (@param)

**基础语法：**
```
@param <参数名> <类型> <描述> # [选项配置]
```

**参数名规范：**
- 支持字母、数字、下划线
- 支持中文参数名
- 不能包含特殊字符（如空格、逗号、冒号等）
- 建议使用驼峰命名法或下划线命名法

**类型系统：**
- **基础类型**: `string`、`number`、`boolean`、`function`、`any`
- **复杂类型**: `table`（支持对象、数组、混合类型）
- **数组类型**: `string[]`、`number[]`、`boolean[]`、`table[]`
- **自定义类型**: `$CustomType`（如 `$Part`、`$User` 等）

**描述规范：**
- 使用中文描述参数用途
- 描述应简洁明了
- 可以包含使用说明和注意事项

**示例：**
```
@param userId number 用户ID # default:100
@param status string 状态 # options:[{"启用":"1"},{"禁用":"0"}] default:"1"
@param mode boolean 强制选择框 # options:[{"使用实体模型":true},{"使用obb包围盒":false}] default:true componentType:select
@param dir table 方向 # options:["up","down","left","right"] default:["up"] componentType:select-multi
@param expression function 表达式函数 # default:null
@param config any 配置对象 # default:{}
```

#### 1.3 字段定义 (@field)

用于定义复杂对象(table)的子字段结构，支持多种复杂类型定义：

**基础语法：**
```
@field <父对象名>.<字段名> <类型> <描述>
@field <父对象名>[].<字段名> <类型> <描述>  # 数组元素字段
@field <父对象名>[] $<自定义类型> <描述>  # 自定义类型数组
```

**字段路径规范：**
- **对象字段**: `user.name` - 表示user对象的name属性
- **数组字段**: `users[].name` - 表示users数组中每个元素的name属性
- **自定义类型**: `users[] $Part` - 表示users数组中的每个元素都是Part类型
- **嵌套字段**: `user.address.city` - 支持多级嵌套

**table类型支持的不同结构：**

1. **简单对象类型**：
```
@param user table 用户信息 # default:{}
@field user.name string 用户名
@field user.age number 年龄
@field user.email string 邮箱地址
@field user.isActive boolean 是否激活
```

2. **简单数组类型**：
```
@param tags table 标签列表 # default:[]
@field tags[] string 标签值
```

3. **数字数组类型**：
```
@param scores table 分数列表 # default:[]
@field scores[] number 分数值
```

4. **对象数组类型**：
```
@param users table 用户列表 # default:[]
@field users[].id number 用户ID
@field users[].name string 用户名
@field users[].age number 年龄
@field users[].email string 邮箱
```

5. **混合类型数组**：
```
@param items table 混合项目列表 # default:[]
@field items[] string 字符串项目
@field items[] number 数字项目
@field items[] boolean 布尔项目
```

6. **自定义类型数组**：
```
@param parts table 零件列表 # default:[]
@field parts[] $Part 自定义Part类型
@field parts[].id string 零件ID
@field parts[].name string 零件名称
@field parts[].type string 零件类型
```

7. **嵌套对象类型**：
```
@param company table 公司信息 # default:{}
@field company.name string 公司名称
@field company.address table 公司地址
@field company.address.street string 街道
@field company.address.city string 城市
@field company.address.country string 国家
```

8. **嵌套数组类型**：
```
@param departments table 部门列表 # default:[]
@field departments[].name string 部门名称
@field departments[].employees table 员工列表
@field departments[].employees[].id number 员工ID
@field departments[].employees[].name string 员工姓名
```

**示例：**
```
@param user table 用户信息 # default:{}
@field user.name string 用户名
@field user.age number 年龄

@param users table 用户列表 # default:[]
@field users[].name string 用户名
@field users[].age number 年龄

@param users table 用户列表 # default:[]
@field users[] $Part 自定义类型用于说明是数组的每个item的类型 
@field users[].name string 用户名&说明Part有的属性
@field users[].age number 年龄&说明Part有的属性&后续扩展可选给下游
```

#### 1.4 返回值定义 (@return)

用于定义函数的返回值类型和结构：

**基础语法：**
```
@return <类型> <描述>
@field return[].<字段名> <类型> <描述>  # 返回值数组字段
@field return.<字段名> <类型> <描述>   # 返回值对象字段
```

**返回值类型支持：**

1. **基础类型返回值**：
```
@return string 返回状态信息
@return number 返回计算结果
@return boolean 返回操作是否成功
@return function 返回回调函数
@return any 返回任意类型数据
```

2. **简单对象返回值**：
```
@return table 返回用户信息
@field return.name string 用户名
@field return.age number 年龄
@field return.email string 邮箱地址
```

3. **数组返回值**：
```
@return table 返回用户列表
@field return[].id number 用户ID
@field return[].name string 用户名
@field return[].status string 用户状态
```

4. **复杂嵌套返回值**：
```
@return table 返回部门信息
@field return.name string 部门名称
@field return.employees table 员工列表
@field return.employees[].id number 员工ID
@field return.employees[].name string 员工姓名
@field return.employees[].position string 职位
@field return.manager table 部门经理
@field return.manager.id number 经理ID
@field return.manager.name string 经理姓名
```

5. **自定义类型返回值**：
```
@return table 返回零件信息
@field return[] $Part 零件列表
@field return[].id string 零件ID
@field return[].name string 零件名称
@field return[].type string 零件类型
@field return[].dimensions table 尺寸信息
@field return[].dimensions.length number 长度
@field return[].dimensions.width number 宽度
@field return[].dimensions.height number 高度
```

**返回值字段命名规范：**
- 使用 `return` 作为根节点
- 对象字段使用 `return.字段名`
- 数组字段使用 `return[].字段名`
- 支持多级嵌套结构
- 字段名应具有描述性

### 2. 解析流程

#### 2.1 注释提取阶段
1. 使用 `luaparse` 库解析Lua代码生成AST
2. 从AST中提取所有注释节点
3. 过滤出以 `@` 开头的特殊注释

#### 2.2 参数解析阶段
1. **@param解析**: 使用正则表达式提取参数名、类型、描述和选项
2. **@field解析**: 解析复杂对象的子字段结构，支持数组和自定义类型
3. **@return解析**: 提取返回值信息，支持返回值数组和对象字段定义

#### 2.3 类型分析阶段
1. **基础类型**: string、number、boolean、function、any
2. **复杂类型**: table（支持对象和数组）
3. **数组类型**: 自动识别 `[]` 后缀
4. **自定义类型**: 支持 `$` 前缀的自定义类型定义
5. **子类型分析**: 通过@field注释分析table的具体结构

#### 2.4 表单配置生成阶段
1. 根据参数类型映射到对应的表单组件
2. 处理默认值和选项配置
3. 生成FormRenderer可用的配置对象
4. 应用数据压缩优化

### 3. 类型映射规则

| Lua类型 | 表单组件 | 特殊处理 |
|---------|----------|----------|
| string | input | 支持options时转为select |
| number | inputNumber | 支持min/max限制 |
| boolean | switch | 支持options时显示开关文本 |
| table | input | 根据paramSubType显示类型信息 |
| function | function | 函数类型专用组件 |
| any | input | 通用输入组件 |
| string[] | input | 逗号分隔输入 |
| number[] | input | 逗号分隔输入 |
| object[] | textarea | JSON格式输入 |
| $CustomType[] | textarea | 自定义类型数组 |

### 4. 高级选项解析

`#` 符号后的选项配置用于控制表单组件的显示和行为，支持多种配置选项：

#### 4.1 默认值配置 (default)
```
default:<值>
```

**支持的数据类型：**
- **字符串**: `default:"hello"`、`default:'world'`
- **数字**: `default:100`、`default:3.14`、`default:-5`
- **布尔值**: `default:true`、`default:false`
- **数组**: `default:[1,2,3]`、`default:["a","b","c"]`
- **对象**: `default:{name:"test",age:18}`、`default:{enabled:true,count:0}`

**使用示例：**
```
@param name string 用户名 # default:"张三"
@param age number 年龄 # default:25
@param isActive boolean 是否激活 # default:true
@param tags table 标签列表 # default:["重要","紧急"]
@param config table 配置信息 # default:{theme:"dark",lang:"zh-CN"}
```

#### 4.2 选项配置 (options)
```
options:[{"选项1":"值1"},{"选项2":"值2"}]
options:["选项1","选项2"]
```

**选项格式说明：**
- **对象格式**: `[{"显示文本":"实际值"},{"显示文本":"实际值"}]`
- **数组格式**: `["选项1","选项2","选项3"]`（显示文本和值相同）
- **混合格式**: 支持字符串、数字、布尔值混合

**使用示例：**
```
@param status string 状态 # options:[{"启用":"1"},{"禁用":"0"}] default:"1"
@param type string 类型 # options:["用户","管理员","超级管理员"] default:"用户"
@param mode boolean 模式 # options:[{"开启":true},{"关闭":false}] default:true
@param priority number 优先级 # options:[{"低":1},{"中":2},{"高":3}] default:2
```

#### 4.3 组件类型指定 (componentType)
```
componentType:select
componentType:select-multi
componentType:switch
componentType:input
componentType:textarea
```

**支持的组件类型：**
- **select**: 单选下拉框
- **select-multi**: 多选下拉框
- **switch**: 开关组件
- **input**: 输入框
- **textarea**: 文本域
- **inputNumber**: 数字输入框

**使用示例：**
```
@param direction string 方向 # options:["上","下","左","右"] componentType:select default:"上"
@param colors table 颜色列表 # options:["红","绿","蓝","黄"] componentType:select-multi default:["红","绿"]
@param enabled boolean 是否启用 # componentType:switch default:true
@param description string 详细描述 # componentType:textarea default:""
```

#### 4.4 多选标记 (multiple)
```
multiple:true
multiple:false
```

**功能说明：**
- 自动标记为多选模式
- 与 `componentType:select-multi` 配合使用
- 支持数组类型的默认值

**使用示例：**
```
@param roles table 角色列表 # options:["管理员","编辑者","查看者"] multiple:true default:["查看者"]
@param permissions table 权限列表 # options:[{"读":"read"},{"写":"write"},{"执行":"execute"}] multiple:true
```

#### 4.5 数值范围限制 (min/max)
```
min:1 max:100
min:-100 max:1000
```

**功能说明：**
- 设置数值输入的最小值和最大值
- 仅对 `number` 类型和 `inputNumber` 组件有效
- 支持负数和小数

**使用示例：**
```
@param score number 分数 # min:0 max:100 default:60
@param temperature number 温度 # min:-273.15 max:1000 default:25
@param percentage number 百分比 # min:0 max:100 default:50
```

#### 4.7 默认选项 (defaultOptions)
```
defaultOptions:true
defaultOptions:false
```

**功能说明：**
- 启用默认选项功能
- 自动合并参数列表和选项
- 提供更丰富的选择

**使用示例：**
```
@param target string 目标对象 # defaultOptions:true componentType:select
@param source string 源对象 # defaultOptions:true componentType:select
```

#### 4.8 字段描述 (desc)
```
desc:详细描述信息
desc:包含换行符的\n多行描述
```

**功能说明：**
- 提供参数的详细说明
- 支持换行符 `\n`
- 在表单中显示为帮助提示

**使用示例：**
```
@param algorithm string 算法类型 # options:["AES","RSA","MD5"] desc:选择加密算法类型，AES适合对称加密，RSA适合非对称加密
@param timeout number 超时时间 # min:1000 max:60000 desc:设置请求超时时间，单位为毫秒\n建议值：5000-30000
```

#### 4.9 组合使用示例

**复杂参数配置：**
```
@param user table 用户信息 # default:{} paramGroup:basic
@field user.name string 用户名
@field user.age number 年龄 # min:1 max:120
@field user.gender string 性别 # options:[{"男":"male"},{"女":"female"}] default:"male" componentType:select
@field user.email string 邮箱地址 # desc:请输入有效的邮箱地址格式
@field user.roles table 角色列表 # options:["管理员","编辑者","查看者"] multiple:true default:["查看者"] componentType:select-multi
@field user.settings table 用户设置 # default:{theme:"light",lang:"zh-CN"}
@field user.settings.theme string 主题 # options:["light","dark","auto"] default:"light"
@field user.settings.lang string 语言 # options:["zh-CN","en-US","ja-JP"] default:"zh-CN"
```

**返回值配置：**
```
@return table 返回用户信息
@field return.success boolean 操作是否成功
@field return.message string 返回消息
@field return.data table 返回数据
@field return.data.id number 用户ID
@field return.data.name string 用户名
@field return.data.roles table 角色列表
@field return.data.roles[] string 角色名称
@field return.timestamp number 时间戳
@field return.version string 版本号
```

### 5. 注释规范总结

#### 5.1 基本语法规则
- **注释标记**: 必须以 `-- @` 开头
- **参数定义**: `@param <参数名> <类型> <描述> # [选项配置]`
- **字段定义**: `@field <父对象名>.<字段名> <类型> <描述>`
- **返回值定义**: `@return <类型> <描述>`

#### 5.2 类型系统规范
- **基础类型**: `string`、`number`、`boolean`、`function`、`any`
- **复杂类型**: `table`（支持对象、数组、混合类型）
- **数组类型**: 使用 `[]` 后缀，如 `string[]`、`number[]`
- **自定义类型**: 使用 `$` 前缀，如 `$Part`、`$User`

#### 5.3 选项配置规范
- **默认值**: `default:<值>` - 支持所有基本数据类型
- **选项列表**: `options:[...]` - 支持对象和数组格式
- **组件类型**: `componentType:<类型>` - 指定表单组件类型
- **多选模式**: `multiple:true` - 启用多选功能
- **数值范围**: `min:<值> max:<值>` - 设置数值范围
- **参数分组**: `paramGroup:<组名>` - 参数分组管理
- **默认选项**: `defaultOptions:true` - 启用默认选项
- **字段描述**: `desc:<描述>` - 详细说明信息

#### 5.4 最佳实践建议
1. **命名规范**: 使用有意义的参数名，支持中文
2. **类型准确**: 选择最合适的类型，避免使用 `any`
3. **描述清晰**: 提供简洁明了的参数说明
4. **默认值合理**: 设置合理的默认值，提高用户体验
5. **选项完整**: 为枚举类型提供完整的选项列表
6. **分组合理**: 使用参数分组优化表单布局
7. **验证完整**: 为数值类型设置合理的范围限制
8. **文档完整**: 为复杂参数提供详细的字段定义

#### 5.5 常见错误和注意事项
- **注释格式**: 确保 `-- @` 后有空格，参数间用空格分隔
- **类型匹配**: 确保 `@field` 中引用的参数名与 `@param` 中的名称一致
- **选项格式**: 数组和对象使用方括号 `[]` 和花括号 `{}`
- **字符串转义**: 在描述中使用特殊字符时注意转义
- **嵌套层级**: 避免过深的嵌套层级，建议不超过3层
- **命名冲突**: 避免参数名与Lua关键字冲突

## 表单渲染逻辑

### 1. SimpleFormRenderer组件特性

#### 1.1 动态组件渲染
- 根据配置自动选择对应的Element Plus组件
- 支持input、select、switch、inputNumber、textarea、function等类型
- 自动处理组件属性和事件绑定

#### 1.2 标签显示模式
- **类型信息模式**: 显示参数类型信息，格式为"标签名(类型)"
- 支持Tooltip显示详细的子类型信息
- 自动显示paramSubType信息

#### 1.3 输入模式切换
- **手动输入模式**: 用户直接输入值
- **节点选择模式**: 从预定义节点列表中选择（预留功能）

#### 1.4 响应式数据管理
- 使用Vue 3的响应式系统
- 支持v-model双向绑定
- 自动处理默认值填充
- 实时数据同步

### 2. 表单数据管理

#### 2.1 数据绑定
- 使用Vue 3的响应式系统
- 支持v-model双向绑定
- 自动处理默认值填充
- 实时数据验证

#### 2.2 验证规则
- 支持Element Plus的表单验证
- 自动生成必填验证规则
- 可扩展自定义验证逻辑
- 实时错误提示

## 智能函数检测功能

### 1. 函数识别逻辑
- 自动检测非局部函数定义（排除local关键字）
- 提取函数名和参数信息
- 自动填充类名和方法名
- 参数数量验证和一致性检查

### 2. 函数信息提取
```typescript
const extractFunctionInfo = (ast: any) => {
  // 查找所有非局部函数定义
  const globalFunctions = ast.body
    .filter(node => node.type === 'FunctionDeclaration' && !node.isLocal)
    .map(node => ({
      name: node.identifier?.identifier?.name,
      parameters: node.parameters?.map(p => p.name) || []
    }))
    .filter(func => func.name)
}
```

### 3. 自动填充机制
- 类名自动生成（下划线转连字符）
- 方法名自动提取
- 参数数量自动统计
- 智能提示和警告

### 4. 函数验证机制
- 参数数量一致性检查
- 函数定义格式验证
- 非局部函数检测
- 智能错误提示

## 数据压缩和优化

### 1. 压缩策略

#### 1.1 参数数据压缩
- 只保存非默认值
- 移除空值和undefined
- 压缩属性对象
- 优化数组和对象结构

#### 1.2 函数配置压缩
- 压缩formConfig配置
- 压缩widgetList数据
- 移除冗余字段
- 保持数据完整性

### 2. 性能优化

#### 2.1 缓存机制
- 默认值对象缓存
- 字符串模板缓存
- 深度比较优化
- 内存使用优化

#### 2.2 数据展开
- 自动恢复完整结构
- 填充默认值
- 生成唯一ID
- 保持向后兼容

## 模板系统

### 1. 模板管理

#### 1.1 预定义模板
- 提供标准化的Lua函数模板
- 支持复杂参数结构示例
- 包含完整的注释说明

#### 1.2 模板操作
- 模板加载和覆盖确认
- 示例注释插入
- 模板版本管理

### 2. 模板示例

#### 2.1 模板01: 找目标素材的父级
```lua
-- 模板01: 找目标素材的父级
local _M = {}

local table = require("core.table")
local part = require("scene.part")

-- 参数示例
-- @param expression function 表达式
-- @param input_parts table 复杂对象 # default:{}
-- @field input_parts.id string Part对象ID
-- @field input_parts.name string Part对象名称
-- @param ids table 简单数组 # default:[]
-- @field ids[] number id值
-- @param op string 单选列表 # options:["IN","NOTIN",">","<",">=","<=","=","<>"] default:"IN"
-- @param value string 简单字符串 # default:""
-- @param deep number 简单数值 # default:1
-- @param dir table 多选列表 # options:["up","down","left","right"] default:["up"] componentType:select-multi
-- @field dir[] string 方向值
-- @param mode boolean 强制选择框 # options:[{"使用实体模型":true},{"使用obb包围盒":false}] default:true componentType:select
-- @return table 返回符合条件的对象列表
-- @field return[].part table Part对象
-- @field return[].parent table 符合条件的父级Part对象列表
function _M.get_parent(expression, input_parts, ids, op, value, deep, dir, mode)
    
end

return _M
```

#### 2.2 模板特性
- **预定义模板**: 提供标准化的Lua函数模板
- **复杂参数结构**: 支持各种类型的参数示例
- **完整注释说明**: 包含所有必要的注释格式
- **实际应用场景**: 基于真实业务需求设计
- **易于扩展**: 支持自定义模板添加

## 工作流程

### 1. 初始化流程
1. 加载函数数据（如果是编辑模式）
2. 解析现有的configData配置
3. 应用数据展开优化
4. 设置Lua编辑器内容
5. 执行Lua2FormJson解析

### 2. 代码解析流程
1. 用户点击"更新表单配置"按钮
2. 获取Lua编辑器中的代码内容
3. 使用luaparse解析代码生成AST
4. 提取并过滤特殊注释
5. 调用parseLuaToFormConfig生成表单配置
6. 更新入参和出参配置
7. 设置表单默认值
8. 应用数据压缩优化
9. **智能函数检测**: 自动识别函数定义和参数信息
10. **参数验证**: 检查参数数量一致性和类型匹配

### 3. 保存流程
1. 验证基本信息的完整性
2. 校验参数配置的有效性
3. 组装函数配置数据
4. 应用数据压缩优化
5. 调用后端API保存数据

## 关键功能点

### 1. 智能函数检测
- 自动检测非局部函数定义
- 提取函数名和参数信息
- 自动填充类名和方法名
- 参数数量验证和一致性检查

### 2. 错误处理
- Lua语法错误检测
- 注释格式验证
- 类型匹配检查
- 用户友好的错误提示
- 实时错误反馈

### 3. 数据持久化
- 配置数据JSON序列化
- 数据压缩优化
- 与后端API的数据交互
- 编辑状态的保存和恢复

### 4. 用户体验优化
- 实时预览表单配置
- 智能默认值填充
- 模板快速加载
- 示例注释插入
- 帮助文档集成

## 扩展性设计

### 1. 组件扩展
- 支持新增表单组件类型
- 可自定义组件映射规则
- 灵活的属性配置机制
- 插件化架构设计

### 2. 注释格式扩展
- 支持新的注释类型
- 可扩展选项配置格式
- 自定义验证规则支持
- 类型系统扩展

### 3. 模板系统扩展
- 支持自定义模板
- 模板版本管理
- 模板导入导出
- 社区模板分享

## 技术特性

### 1. 性能优化
- 数据压缩减少存储空间
- 缓存机制提高响应速度
- 懒加载和按需渲染
- 内存使用优化

### 2. 类型安全
- TypeScript类型检查
- 运行时类型验证
- 类型兼容性检查
- 类型推导优化

### 3. 可维护性
- 模块化架构设计
- 清晰的代码结构
- 完善的错误处理
- 详细的代码注释

## 注意事项

### 1. 注释格式要求
- 必须严格按照指定格式编写注释
- 参数名不能包含特殊字符
- 类型必须是系统支持的类型
- 选项配置必须符合JSON格式

### 2. 数据兼容性
- 支持向后兼容的数据格式
- 自动处理数据迁移
- 版本控制机制
- 数据完整性验证

### 3. 性能考虑
- 大数据量时的性能优化
- 内存使用监控
- 缓存策略调整
- 异步处理机制

## 可能出现的问题

### 1. 注释解析失败
- 检查注释格式是否正确
- 确认参数名和类型是否有效
- 验证选项配置的JSON格式
- 检查特殊字符转义

### 2. 表单显示异常
- 检查组件类型映射是否正确
- 确认默认值格式是否匹配
- 验证选项数组结构
- 检查类型信息显示

### 3. 保存失败
- 检查必填字段是否完整
- 确认参数类型是否支持
- 验证配置数据格式
- 检查网络连接状态

### 4. 性能问题
- 监控内存使用情况
- 检查数据压缩效果
- 优化缓存策略
- 分析性能瓶颈

## 更新日志

### v3.0.0 (当前版本)
- **智能函数检测**: 新增自动检测非局部函数定义功能
- **类型系统增强**: 支持function、any等新类型，改进自定义类型支持
- **模板管理优化**: 改进模板管理系统，支持模板覆盖确认
- **用户界面优化**: 优化用户界面和交互体验，新增帮助提示
- **错误处理完善**: 完善错误处理和验证机制，提供用户友好的错误提示
- **性能提升**: 优化数据压缩算法，提升整体性能和可维护性
- **新功能支持**: 新增参数分组、范围限制、默认选项等功能
- **Monaco Editor增强**: 支持代码下载、复制、全屏编辑等高级功能

### v2.0.0
- 新增数据压缩和优化功能
- 改进类型系统和自定义类型支持
- 增强模板管理系统
- 优化用户界面和交互体验
- 完善错误处理和验证机制
- 提升性能和可维护性
