var B=Object.defineProperty;var k=(s,o,n)=>o in s?B(s,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[o]=n;var w=(s,o,n)=>(k(s,typeof o!="symbol"?o+"":o,n),n);import{d as defineComponent,j as onMounted,A as onBeforeUnmount,k as watch,r as resolveComponent,o as openBlock,c as createElementBlock,h as createBlock,f as createBaseVNode,e as createVNode,i as withCtx,B as withModifiers,x as createCommentVNode,T as Teleport,F as Fragment,m as ref,s as ElMessage,u as unref,C as document_copy_default,y as close_default,D as full_screen_default,l as renderList,G as ElFormItem,g as createTextVNode,v as toDisplayString,H as ElTooltip,I as ElSelect,J as ElOption,K as resolveDynamicComponent,L as ElButton,M as ElIcon,N as switch_default,O as ElForm,n as reactive,P as ElInput,Q as ElSwitch,R as ElInputNumber,S as onActivated,a as createStaticVNode,E as ElMessageBox,U as ElNotification,V as bottom_default,W as right_default}from"./index-1b7a9618.js";import{M as MonacoManager,g as getDefaultMonacoEditorConfig,B as BaseFunctionExpression}from"./index-2d2deec5.js";import{_ as _export_sfc,h as http}from"./_plugin-vue_export-helper-68e29187.js";import{u as useFunctionStore}from"./ruleCache-2bb6c17e.js";import{c as compressFunctionConfig,e as expandFunctionConfig}from"./DataOptimizer-aded8d7d.js";import"./useDialogDrag-547cdc70.js";const _hoisted_1$2={key:0,class:"base-fullscreen-editor-overlay"},_hoisted_2$2={class:"base-fullscreen-editor-container"},_hoisted_3$2={class:"base-editor-toolbar"},_hoisted_4$2={class:"base-editor-wrapper"},_hoisted_5$2={class:"base-editor-toolbar"},__default__$2=defineComponent({name:"BaseEditor"}),_sfc_main$3=defineComponent({...__default__$2,props:{language:{type:String,default:"typescript"},modelValue:{type:String,default:"",required:!0}},emits:["update:modelValue"],setup(s,{expose:o,emit:n}){const i=MonacoManager.getInstance(),d=ref();let c=null,a=null;const p=ref(!1),h=ref();let m=null,e=null;const _=n,g=s;onMounted(()=>{i.createInstance(d.value,{...getDefaultMonacoEditorConfig(),value:g.modelValue,language:g.language}).then(({id:l,editor:x})=>{c=l,a=x,a.onDidChangeModelContent(()=>{_("update:modelValue",a==null?void 0:a.getValue())})})}),onBeforeUnmount(()=>{i.disposeInstance(c),i.disposeInstance(m)}),watch(()=>g.modelValue,l=>{a&&l!==a.getValue()&&a.setValue(l)},{immediate:!1});const r=()=>{if(a){const l=a.getValue();navigator.clipboard.writeText(l).then(()=>{ElMessage.success("代码内容已复制到剪贴板")}).catch(()=>{ElMessage.error("复制失败，请手动选择复制")})}},v=()=>{p.value=!p.value,p.value?(document.body.style.overflow="hidden",setTimeout(()=>{b()},100)):document.body.style.overflow=""},b=()=>{i.createInstance(h.value,{...getDefaultMonacoEditorConfig(!0),value:(a==null?void 0:a.getValue())||"",language:g.language}).then(({id:l,editor:x})=>{e=x,m=l,e.onDidChangeModelContent(()=>{const f=(e==null?void 0:e.getValue())||"";_("update:modelValue",f),a&&a.setValue(f)}),setTimeout(()=>{e==null||e.layout(),e==null||e.focus()},100)})};return o({setValue:l=>{a==null||a.setValue(l)},getValue:()=>(a==null?void 0:a.getValue())||"",copyContent:r,toggleFullscreen:v}),(l,x)=>{const f=resolveComponent("el-icon"),C=resolveComponent("el-button");return openBlock(),createElementBlock(Fragment,null,[(openBlock(),createBlock(Teleport,{to:"body"},[p.value?(openBlock(),createElementBlock("div",_hoisted_1$2,[createBaseVNode("div",_hoisted_2$2,[createBaseVNode("div",_hoisted_3$2,[createVNode(C,{type:"primary",size:"small",circle:"",onClick:withModifiers(r,["stop"])},{default:withCtx(()=>[createVNode(f,null,{default:withCtx(()=>[createVNode(unref(document_copy_default))]),_:1})]),_:1}),createVNode(C,{type:"primary",size:"small",circle:"",onClick:withModifiers(v,["stop"])},{default:withCtx(()=>[createVNode(f,null,{default:withCtx(()=>[createVNode(unref(close_default))]),_:1})]),_:1})]),createBaseVNode("div",{ref_key:"fullEditorContainer",ref:h,class:"monaco-editor-container"},null,512)])])):createCommentVNode("",!0)])),createBaseVNode("div",_hoisted_4$2,[createBaseVNode("div",_hoisted_5$2,[createVNode(C,{type:"primary",size:"small",circle:"",onClick:withModifiers(r,["stop"])},{default:withCtx(()=>[createVNode(f,null,{default:withCtx(()=>[createVNode(unref(document_copy_default))]),_:1})]),_:1}),createVNode(C,{type:"primary",size:"small",circle:"",onClick:withModifiers(v,["stop"])},{default:withCtx(()=>[createVNode(f,null,{default:withCtx(()=>[createVNode(unref(full_screen_default))]),_:1})]),_:1})]),createBaseVNode("div",{ref_key:"editorContainer",ref:d,class:"editorContainer"},null,512)])],64)}}}),BaseEditor_vue_vue_type_style_index_0_scoped_33b73cb6_lang="",BaseEditor=_export_sfc(_sfc_main$3,[["__scopeId","data-v-33b73cb6"]]),__default__$1=defineComponent({name:"BasePre"}),_sfc_main$2=defineComponent({...__default__$1,props:{language:{type:String,default:"json"},preData:{type:Object,default:()=>({}),required:!0}},emits:["update:modelValue"],setup(s,{expose:o,emit:n}){const i=MonacoManager.getInstance(),d=ref();let c=null,a=null;const p=s;return onMounted(()=>{i.createInstance(d.value,{...getDefaultMonacoEditorConfig(),value:JSON.stringify(p.preData,"",1),language:p.language}).then(({id:e,editor:_})=>{c=e,a=_})}),watch(()=>p.preData,e=>{a.setValue(JSON.stringify(e,"",1))},{immediate:!1,deep:!0}),onBeforeUnmount(()=>{i.disposeInstance(c)}),o({setValue:e=>{a==null||a.setValue(e)},getValue:()=>(a==null?void 0:a.getValue())||""}),(e,_)=>(openBlock(),createElementBlock("div",{ref_key:"editorContainer",ref:d,class:"editorContainer"},null,512))}}),BasePre_vue_vue_type_style_index_0_scoped_e30a552c_lang="",BasePre=_export_sfc(_sfc_main$2,[["__scopeId","data-v-e30a552c"]]),SUPPORTED_COMPONENT_TYPES=["input","select","switch","inputNumber","textarea","function"],DEFAULT_FORM_CONFIG={formConfig:{labelWidth:"70px",labelPosition:"right",size:"default",events:{onMounted:""}},compList:[]},DEFAULT_COMP_ATTRIBUTE={value:"",label:"这是组件文案",placeholder:"这是组件未填充提示文案",labelWidth:"",disabled:!1,cssClass:[],paramType:void 0,paramTypeRecord:void 0,compType:void 0,min:void 0,max:void 0};class FormParser{constructor(){}parseJsToFormConfig(o){const n=JSON.parse(JSON.stringify(DEFAULT_FORM_CONFIG));return o.forEach(i=>{const d=this.createComponent(i,SUPPORTED_COMPONENT_TYPES);d&&n.compList.push(d)}),n}createComponent(o,n){const i=this.getCompType(o);return n.includes(i)?{id:o.key,attributes:{...JSON.parse(JSON.stringify(DEFAULT_COMP_ATTRIBUTE)),label:o.name,paramType:o.type,paramTypeRecord:["object","object[]"].includes(o.type)?`${JSON.stringify(o.typeRecord)}${o.type.includes("[]")?"[]":""}`:"",compType:i,placeholder:o.type.endsWith("[]")?`请输入${o.name||o.name}（${["string","number"].includes(o.type.replace("[]",""))?"多个值用逗号分隔":"JSON格式"}）`:"",...o.config}}:null}getCompType(o){switch(o.type){case"string":return"input";case"number":return"inputNumber";case"boolean":return"switch";case"any":case"object":return"input";case"function":return"function";default:if(o.config.compType==="select")return"select";if(o.type.endsWith("[]")){const n=o.type.replace("[]","");return["string","number"].includes(n)?"input":"textarea"}}}}const shouldTypeRecord=s=>s==="object"||s==="object[]";class JSDocParser{constructor(){w(this,"funcTags");this.init()}init(){this.funcTags=[]}parseCode(s){this.init();try{return this.extractJSDocComments(s),this.generateOutput()}catch(o){throw new Error(`解析失败: ${o.message}`)}}extractJSDocComments(s){const o=/\/\*\*[\s\S]*?\*\//g;(s.match(o)||[]).forEach(i=>{const d=this.parseJSDocComment(i);d&&this.funcTags.push(d)})}parseJSDocComment(s){const n=s.replace(/^\/\*\*?/,"").replace(/\*\/$/,"").trim().split(`
`).map(c=>c.replace(/^\s*\*?\s?/,"")),i={desc:"",tags:[]};let d=[];return n.forEach(c=>{if(c.startsWith("@")){const a=c.match(/^@(\w+)\s+(.*)/);if(a){const[,p,h]=a;i.tags.push({tag:p,content:h.trim()})}}else d.push(c)}),i.desc=d.join(`
`).trim(),i.desc||i.tags.length>0?i:null}generateOutput(){const s={metadata:{parsedAt:new Date().toLocaleDateString().replaceAll("/","-")+" "+new Date().toLocaleTimeString(),version:"1.0.0"},functions:[],classes:[],summary:{totalFunctions:0,totalClasses:0,totalTags:0}};return this.funcTags.forEach(o=>{const n=this.extractFunctionInfo(o);n&&s.functions.push(n)}),s.summary.totalFunctions=s.functions.length,s.summary.totalClasses=s.classes.length,s.summary.totalTags=this.funcTags.reduce((o,n)=>o+n.tags.length,0),s}extractFunctionInfo(s){const o={desc:s.desc,input:[],output:[],examples:[]};let n="",i="";for(let a=0;a<s.tags.length;a++){const p=s.tags[a];switch(p.tag){case"param":n=this.matchAndPush(p.content,n,o,"input");break;case"return":case"returns":i=this.matchAndPush(p.content,i,o,"output");break;case"example":o.examples.push(p.content);break}}const d=o.input.filter(a=>!a.type.includes("object")),c=o.output.filter(a=>!a.type.includes("object"));if(new Set(d.map(a=>a.name)).size!==d.length)throw new Error("函数输入字段存在重复");if(new Set(c.map(a=>a.name)).size!==c.length)throw new Error("函数输出字段存在重复");return o.input.length>0||o.output?o:null}matchAndPush(s,o,n,i){const d=s.match(/\{(.*)\}\s+(\S+)\s+(\S+)(\s+\#\s+(.*))?/);if(d){const c=d[1],a=d[2],p=d[3],h=this.extractConfig(d[4]||"#",c),m=n[i].length-1;a.includes(".")&&!shouldTypeRecord(c)&&o===a.split(".")[0]?(n[i][m].typeRecord||(n[i][m].typeRecord={}),n[i][m].typeRecord[a.split(".")[1]]=c):(o=a,n[i].push({key:a,type:c,name:p,config:h}))}return o}extractConfig(config,type){const has=Object.prototype.hasOwnProperty,option=config.split("#")[1].split(";").reduce((s,o)=>{const n=o.indexOf(":");return n!==-1&&(s[o.substr(0,n).trim()]=o.substr(n+1).trim()),s},{});return has.call(option,"value")&&(option.value=type==="number"?Number(option.value):option.value),has.call(option,"options")&&(option.options=eval((option==null?void 0:option.options)||"[]")),has.call(option,"props")&&(option.props=new Function(`return ${option==null?void 0:option.props}`)()),has.call(option,"compType")&&!SUPPORTED_COMPONENT_TYPES.includes(option.compType)&&delete option.compType,option}}const _hoisted_1$1={class:"param-label-col"},_hoisted_2$1={class:"param-label"},_hoisted_3$1={class:"param-type-under"},_hoisted_4$1={class:"form-field-container"},_hoisted_5$1={class:"main-control"},_hoisted_6$1={style:{float:"left"}},_hoisted_7$1={style:{float:"right"}},_hoisted_8$1={key:0,class:"field-attributes-desc"},_hoisted_9$1={key:0,class:"form-desc"},_sfc_main$1=defineComponent({__name:"BaseFormRender",props:{formJson:{type:Object,default:DEFAULT_FORM_CONFIG},showModeToggle:{type:Boolean,default:!0},inputMode:{type:String,default:"manual"},nodeOptions:{type:Array,default:()=>[]},nodeData:{type:Object},workflowData:{type:Object}},emits:["update:modelValue","change","mode-change"],setup(s,{expose:o,emit:n}){const i=s,d=ref();let c=reactive({});const a={input:ElInput,select:ElSelect,switch:ElSwitch,inputNumber:ElInputNumber,textarea:ElInput,function:BaseFunctionExpression},p=m=>a[m]||ElInput,h=ref([]);return watch(()=>i.formJson.compList,m=>{m.forEach(e=>{e.id in c||(c[e.id]=e.attributes.value)}),h.value=m.map((e,_)=>{var g,r;return{id:e.id,type:e.attributes.compType,label:e.attributes.label,placeholder:(g=e.attributes)==null?void 0:g.placeholder,disabled:(r=e.attributes)==null?void 0:r.disabled,defaultValue:e.attributes.value,attributes:e.attributes||{},options:e.attributes.options||[],props:e.attributes.props||[]}})},{deep:!0,once:!0}),o({getFormData:async()=>{var m;try{return await((m=d.value)==null?void 0:m.validate()),c}catch(e){throw e}},setFormData:m=>{c=m},resetForm:()=>{var m;c={},(m=d.value)==null||m.resetFields()},setFormJson:m=>{}}),(m,e)=>{var _,g;return openBlock(),createBlock(unref(ElForm),{"label-width":((_=s.formJson.formConfig)==null?void 0:_.labelWidth)||"70px","label-position":((g=s.formJson.formConfig)==null?void 0:g.labelPosition)||"right",class:"simple-form-renderer",ref_key:"formRef",ref:d,onSubmit:e[1]||(e[1]=withModifiers(()=>{},["prevent"]))},{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(h.value,(r,v)=>(openBlock(),createBlock(unref(ElFormItem),{key:r.id+v,prop:r.id,rules:r.rules},{label:withCtx(()=>[createVNode(unref(ElTooltip),{disabled:!r.attributes.paramTypeRecord,placement:"top"},{content:withCtx(()=>[createTextVNode(toDisplayString(r.attributes.paramTypeRecord),1)]),default:withCtx(()=>[createBaseVNode("div",_hoisted_1$1,[createBaseVNode("span",_hoisted_2$1,toDisplayString(r.label),1),createBaseVNode("span",_hoisted_3$1,"("+toDisplayString(r.attributes.paramType)+")",1)])]),_:2},1032,["disabled"])]),default:withCtx(()=>{var b,u;return[createBaseVNode("div",_hoisted_4$1,[createBaseVNode("div",_hoisted_5$1,[s.inputMode==="manual"?(openBlock(),createElementBlock(Fragment,{key:0},[r.type==="select"?(openBlock(),createBlock(unref(ElSelect),{key:0,modelValue:unref(c)[r.id],"onUpdate:modelValue":t=>unref(c)[r.id]=t,placeholder:r.placeholder,disabled:r.disabled,filterable:"",clearable:"","allow-create":"","default-first-option":"",multiple:r.attributes.multiple},{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(r.options,(t,l)=>(openBlock(),createBlock(unref(ElOption),{key:l,label:t[r.props.label]||t.label,value:t[r.props.value]||t.value},{default:withCtx(()=>[t.desc?(openBlock(),createBlock(unref(ElTooltip),{key:0,content:t.desc,disabled:!t.desc,placement:"top","show-after":500,"popper-class":"field-desc-tooltip","popper-style":{maxWidth:"300px",wordWrap:"break-word",wordBreak:"break-all"}},{default:withCtx(()=>[createBaseVNode("div",null,[createBaseVNode("span",_hoisted_6$1,[createTextVNode(toDisplayString(t.name)+" ",1),createBaseVNode("span",null,toDisplayString(t.label),1)]),createBaseVNode("span",_hoisted_7$1,toDisplayString(t.type),1)])]),_:2},1032,["content","disabled"])):createCommentVNode("",!0)]),_:2},1032,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","disabled","multiple"])):(openBlock(),createBlock(resolveDynamicComponent(p(r.type)),{key:1,modelValue:unref(c)[r.id],"onUpdate:modelValue":t=>unref(c)[r.id]=t,placeholder:r.placeholder,disabled:r.disabled,type:["textarea","function"].includes(r.type)?"textarea":((b=r.attributes)==null?void 0:b.inputType)||"text"},null,8,["modelValue","onUpdate:modelValue","placeholder","disabled","type"]))],64)):(openBlock(),createBlock(unref(ElSelect),{key:1,modelValue:unref(c)[r.id],"onUpdate:modelValue":t=>unref(c)[r.id]=t,placeholder:"请选择节点",filterable:"",clearable:""},{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(s.nodeOptions||[],t=>(openBlock(),createBlock(unref(ElOption),{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onUpdate:modelValue"])),createVNode(unref(ElTooltip),{placement:"top",content:(u=r.attributes)==null?void 0:u.desc},{default:withCtx(()=>{var t;return[(t=r.attributes)!=null&&t.desc?(openBlock(),createElementBlock("div",_hoisted_8$1,toDisplayString(r.attributes.desc),1)):createCommentVNode("",!0)]}),_:2},1032,["content"])]),createVNode(unref(ElTooltip),{disabled:!r.attributes.paramTypeRecord,content:"数据类型切换",placement:"top","show-after":500,"popper-class":"field-desc-tooltip","popper-style":{maxWidth:"300px",wordWrap:"break-word",wordBreak:"break-all"}},{default:withCtx(()=>[createVNode(unref(ElButton),{class:"mode-toggle-btn",disabled:!r.attributes.paramTypeRecord||s.inputMode==="node",onClick:e[0]||(e[0]=t=>m.$emit("mode-change"))},{default:withCtx(()=>[createVNode(unref(ElIcon),null,{default:withCtx(()=>[createVNode(unref(switch_default))]),_:1})]),_:1},8,["disabled"])]),_:2},1032,["disabled"])])]}),_:2},1032,["prop","rules"]))),128)),h.value.length===0?(openBlock(),createElementBlock("div",_hoisted_9$1,"-")):createCommentVNode("",!0)]),_:1},8,["label-width","label-position"])}}}),BaseFormRender_vue_vue_type_style_index_0_scoped_ae18021a_lang="",BaseFormRender=_export_sfc(_sfc_main$1,[["__scopeId","data-v-ae18021a"]]),_hoisted_1={class:"container mx-auto px-3 py-3 flex-1 flex flex-col min-h-0 lg:overflow-hidden"},_hoisted_2={class:"grid grid-cols-1 lg:grid-cols-3 gap-3 lg:flex-1 lg:overflow-hidden lg:min-h-0"},_hoisted_3={class:"bg-white rounded-xl shadow-md border border-theme-lighter p-3 flex flex-col lg:overflow-hidden min-h-[400px] lg:min-h-0 mb-2 mt-0"},_hoisted_4={class:"w-full code-editor focus:ring-2 focus:ring-theme-medium resize-none h-[400px] max-h-[400px] sm:h-[500px] sm:max-h-[500px] overflow-y-auto overflow-x-hidden scrollbar-zero lg:flex-1 lg:h-auto lg:min-h-0 lg:max-h-none lg:overflow-hidden"},_hoisted_5={class:"grid grid-cols-2 sm:grid-cols-4 gap-3 pt-2 mt-2 border-t border-theme-lighter"},_hoisted_6={class:"bg-white rounded-xl shadow-md border border-theme-lighter p-3 flex flex-col lg:overflow-hidden min-h-[300px] sm:min-h-[400px] lg:min-h-0 mb-2 mt-0"},_hoisted_7={class:"bg-gray-900 text-theme-light rounded-lg p-2 overflow-y-auto code-editor h-[300px] max-h-[300px] sm:h-[400px] sm:max-h-[400px] scrollbar-overlay lg:flex-1 lg:h-auto lg:min-h-0 lg:max-h-none"},_hoisted_8={class:"bg-white rounded-xl shadow-md border border-theme-lighter p-3 flex flex-col lg:overflow-hidden min-h-[300px] sm:min-h-[400px] lg:min-h-0 mb-2 mt-0"},_hoisted_9={class:"w-full code-editor focus:ring-2 focus:ring-theme-medium resize-none lg:flex-1 lg:overflow-y-auto lg:min-h-0"},__default__=defineComponent({name:"functionEdit"}),_sfc_main=defineComponent({...__default__,setup(s){const o=new JSDocParser,n=new FormParser,i=()=>`
/**
* 函数demo
* @param {string} name 名字 # placeholder: 请输入名字; desc: 这是很长很长很长很长很长很长很长很长很长很长很长很长很长很长很长很长的描述

* @param {number} price 工资 # placeholder: 请输入工资; value: 1

* @param {number} employee 员工ID # value: 1; options: [{ id: 1, name: '默认员工名称', price: 100 }]; props: { label: 'name', value: 'id', desc: 'price' }; compType: select

* @param {object[]} employees 多员工 # value: [{ id: 1, name: '默认员工名称', price: 100 }];
* @param {number} employees.id 员工Id
* @param {string} employees.name 员工名字
* @param {number} employees.price 员工工资

* @returns {object} employee 员工
* @returns {string} employee.name 员工名字
* @returns {number} employee.price 员工工资
* @example log({ name: '张三', price: 3000 }, [{ name: '张三', price: 3000 }, { name: '李四', price: 2000 }]); // {name: '张三', price: 3000}
*/
function log(employee, employees, name, price) {
  return employee
}
`,d=useFunctionStore(),c=ref(),a=ref(),p=ref(),h=ref(0),m=reactive({input:{formConfig:null,compList:[]},output:{formConfig:null,compList:[]}}),e=reactive({id:"",funcCode:"",functionStatus:"",jsCode:"",js2JsonCode:{},funcDesc:"",funcName:"",className:"",path:"",funcLuaName:"",formJson:{input:{formConfig:{},widgetList:[]},output:{formConfig:{},widgetList:[]},codeJson:{}}}),_=()=>{var f,C;let u="";(!e.id||!e.funcName||!e.className||!e.funcLuaName)&&(u="信息不全，请检查函数名、方法名、文件名");const t=((f=e.formJson.input.widgetList)==null?void 0:f.length)||0,l=((C=e.formJson.output.widgetList)==null?void 0:C.length)||0;t===0&&l===0&&(u="参数信息不全，请至少配置入参或出参"),t!==h.value&&(u="函数入参数量与注释参数数量不一致，请检查注释是否正确");const x=["string","number","boolean","table","any","function"];return e.formJson.input.widgetList.forEach(y=>{const N=y.attributes.paramType,V=y.attributes.paramSubType;N==="table"&&V==="unkonwn"&&(u=`入参 ${y.name}: 的子项类型描述有误 请检查注释是否正确`),x.includes(N)||(u=`入参 ${y.name}: 的类型描述有误 请检查注释是否正确`)}),e.formJson.output.widgetList.forEach(y=>{const N=y.attributes.paramType,V=y.attributes.paramSubType;N==="table"&&V==="unkonwn"&&(u=`出参 ${y.name}: 的子项类型描述有误 请检查注释是否正确`),x.includes(N)||(u=`出参 ${y.name}: 的类型描述有误 请检查注释是否正确`)}),u?(ElNotification({message:u,type:"error",duration:3e3}),!1):!0},g=()=>{if(!_())return;const u={...e.formJson,className:e.className,path:e.path,funcLuaName:e.funcLuaName},t=compressFunctionConfig(u);http.post({url:"/rule-config/func/update",data:{id:e.id,funcName:e.funcName,funcCode:e.funcCode,functionStatus:e.functionStatus,funcDesc:e.funcDesc,jsCode:e.jsCode,configData:JSON.stringify(t)}}).then(l=>{l.data===!0?ElMessage.success({message:"保存成功"}):ElMessage.error({message:"保存失败"})}).catch(l=>{ElMessage.error({message:l.message||"保存失败"})})},r=()=>{e.jsCode="",e.js2JsonCode={}},v=()=>{const u=i();if(e.jsCode!==""){const t="将覆盖当前函数，是否继续？";ElMessageBox.confirm(t,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{e.jsCode=u,ElNotification({type:"success",message:"加载模版成功",duration:1e3}),setTimeout(()=>{b()},1e3)}).catch(()=>{ElNotification({type:"info",message:"取消加载模版"})})}else e.jsCode=u,ElNotification({message:"加载模版成功",type:"success",duration:1e3}),setTimeout(()=>{b()},1e3)},b=()=>{var u,t;if(e.jsCode===""){e.js2JsonCode={};return}try{const l=o.parseCode(e.jsCode);e.js2JsonCode=l,m.input=n.parseJsToFormConfig((u=l.functions[0])==null?void 0:u.input),m.output=n.parseJsToFormConfig((t=l.functions[0])==null?void 0:t.output),ElNotification({message:"函数解析表单成功！",type:"success",duration:1e3})}catch(l){ElNotification({title:"解析失败",message:l.message,type:"error",duration:1e3})}};return onActivated(()=>{const u=d.currentFunction;if(u){e.id=u.id||"",e.funcName=u.funcName||"",e.funcCode=u.funcCode||"",e.jsCode=u.jsCode||"",e.funcDesc=u.funcDesc||"",e.functionStatus=u.functionStatus||"";try{const t=JSON.parse(u.configData),l=expandFunctionConfig(t);e.formJson.input=l.input||{},e.formJson.output=l.output||{},e.className=l.className||"",e.path=l.path||"",e.funcLuaName=l.funcLuaName||""}catch{}d.clearCurrentFunction(),setTimeout(()=>{b()},1e3)}}),(u,t)=>{const l=resolveComponent("el-button"),x=resolveComponent("el-input");return openBlock(),createElementBlock("div",_hoisted_1,[createBaseVNode("div",_hoisted_2,[createBaseVNode("div",_hoisted_3,[t[6]||(t[6]=createBaseVNode("h2",{class:"text-base sm:text-lg font-semibold text-theme-dark mb-2 mt-0 flex items-center"},[createBaseVNode("i",{class:"fas fa-edit mr-2 text-theme-medium"}),createTextVNode(" 代码编辑器 ")],-1)),createBaseVNode("div",_hoisted_4,[createVNode(BaseEditor,{ref_key:"JsEditorRef",ref:p,modelValue:e.jsCode,"onUpdate:modelValue":t[0]||(t[0]=f=>e.jsCode=f)},null,8,["modelValue"])]),createBaseVNode("div",_hoisted_5,[createVNode(l,{icon:unref(bottom_default),onClick:v,class:"bg-theme-light hover:bg-theme-medium text-white border-theme-light"},{default:withCtx(()=>[...t[2]||(t[2]=[createTextVNode(" 模版 ",-1)])]),_:1},8,["icon"]),createVNode(l,{icon:unref(right_default),onClick:b,class:"bg-theme-medium hover:bg-theme-dark text-white border-theme-medium"},{default:withCtx(()=>[...t[3]||(t[3]=[createTextVNode(" 解析 ",-1)])]),_:1},8,["icon"]),createVNode(l,{onClick:r,class:"bg-theme-lighter hover:bg-theme-light text-theme-dark border-theme-lighter"},{default:withCtx(()=>[...t[4]||(t[4]=[createBaseVNode("i",{class:"fas fa-trash mr-2"},null,-1),createTextVNode(" 清空 ",-1)])]),_:1}),createVNode(l,{type:"primary",onClick:g,class:"bg-theme-dark hover:bg-theme-medium text-white border-theme-dark"},{default:withCtx(()=>[...t[5]||(t[5]=[createBaseVNode("i",{class:"fas fa-save mr-2"},null,-1),createTextVNode(" 保存 ",-1)])]),_:1})])]),createBaseVNode("div",_hoisted_6,[t[7]||(t[7]=createBaseVNode("h2",{class:"text-base sm:text-lg font-semibold text-theme-dark mb-2 mt-0 flex items-center"},[createBaseVNode("i",{class:"fas fa-file-code mr-2 text-theme-medium"}),createTextVNode(" 注解解析 ")],-1)),createBaseVNode("div",_hoisted_7,[createVNode(BasePre,{preData:e.js2JsonCode},null,8,["preData"])])]),createBaseVNode("div",_hoisted_8,[t[11]||(t[11]=createBaseVNode("h2",{class:"text-base sm:text-lg font-semibold text-theme-dark mb-2 mt-0 flex items-center"},[createBaseVNode("i",{class:"fas fa-eye mr-2 text-theme-medium"}),createTextVNode(" 表单预览 ")],-1)),createBaseVNode("div",_hoisted_9,[t[8]||(t[8]=createBaseVNode("h4",{class:"text-sm sm:text-base font-medium text-theme-dark mb-2 mt-0"},[createBaseVNode("span",null,"入参配置：")],-1)),createVNode(BaseFormRender,{ref_key:"inputFormRendererRef",ref:c,formJson:m.input},null,8,["formJson"]),t[9]||(t[9]=createBaseVNode("h4",{class:"text-sm sm:text-base font-medium text-theme-dark mb-2 mt-0"},[createBaseVNode("span",null,"出参配置")],-1)),createVNode(BaseFormRender,{ref_key:"outputFormRendererRef",ref:a,formJson:m.output},null,8,["formJson"]),t[10]||(t[10]=createBaseVNode("h4",{class:"text-sm sm:text-base font-medium text-theme-dark mb-2 mt-0"},"备注：",-1)),createVNode(x,{type:"textarea",rows:5,maxlength:"200","show-word-limit":"",modelValue:e.funcDesc,"onUpdate:modelValue":t[1]||(t[1]=f=>e.funcDesc=f),placeholder:"请输入备注.....",class:"w-full"},null,8,["modelValue"])])])]),t[12]||(t[12]=createStaticVNode('<div class="bg-white rounded-xl shadow-md border border-theme-lighter p-3 mt-2" data-v-68088807><h2 class="text-sm sm:text-base font-semibold text-theme-dark mb-2 mt-0 flex items-center" data-v-68088807><i class="fas fa-tools mr-1.5 text-theme-medium text-sm" data-v-68088807></i> 工具说明 </h2><div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2" data-v-68088807><div class="bg-theme-lightest border border-theme-lighter p-2 rounded-lg hover:shadow-md transition-shadow" data-v-68088807><h3 class="font-semibold text-theme-dark mb-1 mt-0 text-xs sm:text-sm" data-v-68088807>JSDoc语法</h3><p class="text-xs text-gray-700 leading-snug mt-0 mb-0" data-v-68088807> 语法支持 <a class="text-theme-medium hover:text-theme-dark font-semibold underline decoration-theme-light hover:decoration-theme-medium transition-colors" href="https://jsdoc.nodejs.cn/" target="_blank" data-v-68088807> JSDoc </a></p></div><div class="bg-theme-lightest border border-theme-lighter p-2 rounded-lg hover:shadow-md transition-shadow" data-v-68088807><h3 class="font-semibold text-theme-dark mb-1 mt-0 text-xs sm:text-sm" data-v-68088807>自主解析JSDoc</h3><div class="text-xs text-gray-700 leading-snug space-y-1" data-v-68088807><p class="mt-0 mb-0" data-v-68088807> 已接入 <strong class="text-theme-dark" data-v-68088807>@param</strong> 、 <strong class="text-theme-dark" data-v-68088807>@return</strong> 、 <strong class="text-theme-dark" data-v-68088807>@example</strong> 等... </p><p class="mt-0 mb-0" data-v-68088807>轻量级解析器，专注于注释解析，注解陆续接入解析中...</p></div></div><div class="bg-theme-lightest border border-theme-lighter p-2 rounded-lg hover:shadow-md transition-shadow sm:col-span-2 lg:col-span-1" data-v-68088807><h3 class="font-semibold text-theme-dark mb-1 mt-0 text-xs sm:text-sm" data-v-68088807>自主解析表单</h3><p class="text-xs text-gray-700 leading-snug mt-0 mb-0" data-v-68088807>轻量级表单生成器</p></div></div></div>',1))])}}}),edit_vue_vue_type_style_index_0_scoped_68088807_lang="",edit=_export_sfc(_sfc_main,[["__scopeId","data-v-68088807"]]);export{edit as default};
