const A={hidden:!1,width:"",labelWidth:"",labelPosition:"",showLabel:!0,disabled:!1,size:"",cssClass:[],inputType:"text",showPassword:!1,multiple:!1,filterable:!0,clearable:!0,paramGroup:null,defaultOptions:null,min:void 0,max:void 0},C={labelWidth:"auto",labelPosition:"right",size:"default",disabled:!1,scrollToError:!0,showMessage:!0,events:{onMounted:""},globalStyle:""},p={input:{formConfig:{...C},widgetList:[]},output:{formConfig:{...C},widgetList:[]},codeJson:{},version:"1.0.0"},l={emptyArray:Object.freeze([]),emptyObject:Object.freeze({}),defaultEvents:Object.freeze({onChange:"",onMounted:""}),defaultAttributes:Object.freeze({...A})},g=new Map;function h(t,e){const i=`${t}:${e}`;if(!g.has(i)){const u=t.replace("${paramName}",e);g.set(i,u)}return g.get(i)}function d(t,e){if(t===e)return!0;if(t==null||e==null)return t===e;if(typeof t!=typeof e)return!1;if(typeof t=="object"){if(Array.isArray(t)!==Array.isArray(e))return!1;if(Array.isArray(t)){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!d(t[n],e[n]))return!1;return!0}const i=Object.keys(t),u=Object.keys(e);if(i.length!==u.length)return!1;for(const n of i)if(!u.includes(n)||!d(t[n],e[n]))return!1;return!0}return!1}function b(t){return t==null||t===""}function T(t){if(!t)return t;const e={};t.paramName&&(e.paramName=t.paramName),t.id&&(e.id=t.id),t.type&&(e.type=t.type),t.subType&&(e.subType=t.subType),t.source!==void 0&&(e.source=t.source),t.sourceType&&(e.sourceType=t.sourceType),t.portId&&(e.portId=t.portId),t.widgetType&&(e.widgetType=t.widgetType),t.functionCode&&(e.functionCode=t.functionCode),b(t.defaultValue)||(e.defaultValue=t.defaultValue);const i=t.options;i&&Array.isArray(i)&&i.length>0&&(e.options=i);const u=t.rules;if(u&&Array.isArray(u)&&u.length>0&&(e.rules=u),t.attributes){const n={},o=t.attributes,y=Object.keys(o);let f=!1;for(const a of y){const c=o[a],s=A[a];!d(c,s)&&!b(c)&&(n[a]=c,f=!0)}o.label&&(n.label=o.label,f=!0),o.paramType&&(n.paramType=o.paramType,f=!0),o.paramSubType&&(n.paramSubType=o.paramSubType,f=!0),o.paramGroup&&(n.paramGroup=o.paramGroup,f=!0),f&&(e.attributes=n)}return e}function r(t,e){return t??e}function m(t){if(!t)return t;const e={};e.paramName=r(t.paramName,""),e.type=r(t.type,"string"),e.subType=r(t.subType,null),e.source=r(t.source,""),e.sourceType=r(t.sourceType,"input"),e.portId=r(t.portId,""),e.widgetType=r(t.widgetType,"input"),t.functionCode&&(e.functionCode=t.functionCode),e.id=r(t.id,N()),e.defaultValue=t.defaultValue!==void 0?t.defaultValue:void 0,e.options=r(t.options,l.emptyArray),e.rules=r(t.rules,l.emptyArray);const i=r(t.attributes,l.emptyObject);return e.attributes={...l.defaultAttributes,...i,label:r(i.label,e.paramName),placeholder:r(i.placeholder,h("请输入${paramName}",e.paramName)),paramType:r(i.paramType,e.type),paramSubType:r(i.paramSubType,e.subType),paramGroup:r(i.paramGroup,null)},e}function w(t){if(!t)return t;const e={};if(t.className&&(e.className=t.className),t.path&&(e.path=t.path),t.funcLuaName&&(e.funcLuaName=t.funcLuaName),t.input){const i={},u=t.input.formConfig||l.emptyObject,n=p.input.formConfig,o={},y=Object.keys(u);let f=!1;for(const s of y)d(u[s],n[s])||(o[s]=u[s],f=!0);f&&(i.formConfig=o);const a=t.input.widgetList;a&&Array.isArray(a)&&(i.widgetList=a.map(T)),Object.keys(i).length>0&&(e.input=i)}if(t.output){const i={},u=t.output.formConfig||l.emptyObject,n=p.output.formConfig,o={},y=Object.keys(u);let f=!1;for(const s of y)d(u[s],n[s])||(o[s]=u[s],f=!0);f&&(i.formConfig=o);const a=t.output.widgetList;a&&Array.isArray(a)&&(i.widgetList=a.map(T)),Object.keys(i).length>0&&(e.output=i)}return t.codeJson&&Object.keys(t.codeJson).length>0&&(e.codeJson=t.codeJson),t.version&&t.version!==p.version&&(e.version=t.version),e}function L(t){if(!t)return t;const e={...p};return t.className&&(e.className=t.className),t.path&&(e.path=t.path),t.funcLuaName&&(e.funcLuaName=t.funcLuaName),t.input&&(e.input={formConfig:{...p.input.formConfig,...t.input.formConfig},widgetList:(t.input.widgetList||l.emptyArray).map(m)}),t.output&&(e.output={formConfig:{...p.output.formConfig,...t.output.formConfig},widgetList:(t.output.widgetList||l.emptyArray).map(m)}),t.codeJson&&(e.codeJson=t.codeJson),t.version&&(e.version=t.version),e}function N(){return`widget_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}export{T as a,w as c,L as e};
